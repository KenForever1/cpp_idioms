+ 内存访问优化‌

使用共享内存（__shared__）加速多次访问的数据‌
合并全局内存访问（row * cols + col连续访问）‌
‌
+ 计算并行化‌

按行并行处理，适应批处理场景（如batch_size=1000）‌
‌
+ 数值稳定性‌

每行独立减去最大值，避免指数溢出‌